function(add_target_shader TARGET SOURCE DESTINATION)
	file(MAKE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/shaders)

	set(SHADER_TARGET_NAME ${SOURCE})
	string(REPLACE  "/" "-" SHADER_TARGET_NAME ${SHADER_TARGET_NAME})

	set(BINARY_FILE ${CMAKE_CURRENT_BINARY_DIR}/shaders/${SHADER_TARGET_NAME}.bin)

	add_custom_target(${SHADER_TARGET_NAME}
			COMMAND glslc ${CMAKE_CURRENT_SOURCE_DIR}/${SOURCE} -o ${BINARY_FILE}
			COMMAND cat ${BINARY_FILE} | xxd -i > ${DESTINATION}
			DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/${SOURCE}
			WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
	)

	add_dependencies(${TARGET} ${SHADER_TARGET_NAME})
endfunction()
