find_package(Python3 REQUIRED)
find_package(Vulkan REQUIRED)


function(add_target_shader TARGET SOURCE DESTINATION)
	cmake_path(GET SOURCE FILENAME SHADER_FILENAME)
	set(SHADER_TARGET_NAME ${TARGET}-${SHADER_FILENAME})

	add_custom_command(OUTPUT ${DESTINATION}
			COMMAND Python3::Interpreter ${CMAKE_CURRENT_SOURCE_DIR}/share/compile_shader.py ${Vulkan_GLSLC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/${SOURCE} ${DESTINATION}
			DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/${SOURCE}
			WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
	)

	add_custom_target(${SHADER_TARGET_NAME}
			DEPENDS ${CMAKE_CURRENT_SOURCE_DIR}/${SOURCE}
	)

	add_dependencies(${TARGET} ${SHADER_TARGET_NAME})
endfunction()
